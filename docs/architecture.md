# Архитектура

Проект разбит на отдельные микросервисы и инфраструктурные компоненты:

- **Telegram-бот (aiogram)** — принимает платежи Telegram Stars, выдает триал и конфиги, отправляет напоминания.
- **Billing (FastAPI)** — тарификация, работа с промокодами/рефералкой, выставление инвойсов.
- **Provisioner (FastAPI)** — генерация конфигураций AmneziaWG/WireGuard/OpenVPN и QR-кодов, ограничение скорости/устройств.
- **Dashboard (FastAPI + Jinja2)** — простая веб-панель для статусов и скачивания конфигов.
- **База данных (PostgreSQL)** — хранение подписок, платежей, рефералок, устройств.
- **Redis** — кеш и сессионные данные бота.
- **MinIO/R2** — безопасное хранение конфигов, QR и бэкапов.

В `docker-compose.yml` описаны сервисы для локального и стартового прод-окружения. Подключение к Neon/Yandex Managed можно сделать заменой хоста/порта в переменных окружения без изменения кода.
